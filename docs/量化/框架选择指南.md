# 量化交易框架选择指南

## 概述

本项目支持多种量化交易框架，每个框架都有其特点和适用场景。

## 框架列表

### 1. Backtrader

**位置**: `src/model/backtrader/`

**特点**:
- ✅ 功能强大，支持复杂的策略开发
- ✅ 内置大量技术指标
- ✅ 支持多数据源、多策略
- ✅ 丰富的分析器（回撤、夏普比率等）
- ⚠️ 学习曲线较陡
- ⚠️ 代码量相对较多

**适用场景**:
- 复杂策略开发
- 需要详细回测分析
- 多股票组合策略
- 分钟级/日线级回测

**快速开始**:
```python
from model.backtrader import BacktestEngine
from model.backtrader.strategy.sma_cross_strategy import SMACrossStrategy

engine = BacktestEngine(initial_cash=100000.0)
engine.add_data(symbol="000651", start_date="2024-01-01", end_date="2024-12-31")
engine.add_strategy(SMACrossStrategy, fast_period=5, slow_period=20)
result = engine.run()
```

**文档**:
- [Backtrader 框架最佳实践](./Backtrader框架最佳实践.md)
- [Backtrader 框架架构](./Backtrader框架架构.md)

---

### 2. VnPy（待实现）

**位置**: `src/model/vnpy/`（计划中）

**特点**:
- ✅ 实盘交易支持
- ✅ 多接口支持（CTP、IB等）
- ✅ 事件驱动架构
- ✅ 完整的交易系统
- ⚠️ 主要用于实盘，回测功能相对简单

**适用场景**:
- 实盘交易
- 需要连接多个交易接口
- 事件驱动策略
- 完整的交易系统

**状态**: 待实现

---

## 如何选择框架

### 选择 Backtrader 如果：

1. **主要做回测**：Backtrader 的回测功能非常强大
2. **需要复杂策略**：支持多数据源、多策略组合
3. **需要详细分析**：内置丰富的分析器
4. **学习能力强**：愿意花时间学习框架

### 选择 VnPy 如果：

1. **需要实盘交易**：VnPy 专注于实盘交易
2. **需要多接口**：需要连接多个交易接口
3. **事件驱动策略**：策略基于事件驱动
4. **完整交易系统**：需要完整的交易系统功能

---

## 框架对比

| 特性 | Backtrader | VnPy |
|------|-----------|------|
| **回测功能** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| **实盘交易** | ❌ | ⭐⭐⭐⭐⭐ |
| **易用性** | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| **性能** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **文档** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **社区** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 项目结构

```
src/model/
├── backtrader/        # Backtrader 框架
│   ├── core/          # 核心处理
│   ├── strategy/      # 策略库
│   └── trigger/       # 触发机制
├── vnpy/              # VnPy 框架（待实现）
│   ├── engine/        # 交易引擎
│   ├── strategy/      # 策略库
│   └── interface/     # 交易接口
└── common/            # 通用工具（可选）
    ├── data/          # 数据接口
    └── utils/         # 工具函数
```

---

## 迁移指南

### 从 Backtrader 迁移到 VnPy

如果将来需要从 Backtrader 迁移到 VnPy：

1. **策略逻辑**：大部分策略逻辑可以复用
2. **数据接口**：使用 `common/data` 统一数据接口
3. **交易接口**：需要适配 VnPy 的交易接口
4. **事件处理**：需要改为事件驱动模式

---

## 最佳实践

### 1. 策略开发

- 将策略逻辑与框架解耦
- 使用统一的数据接口
- 将业务逻辑封装为独立函数

### 2. 代码组织

```
strategy/
├── base.py              # 策略基类（框架相关）
├── logic.py             # 策略逻辑（框架无关）
└── adapters/            # 框架适配器
    ├── backtrader_adapter.py
    └── vnpy_adapter.py
```

### 3. 数据接口

- 使用统一的数据获取接口
- 数据格式标准化
- 支持多种数据源

---

## 总结

- **回测为主** → 选择 Backtrader
- **实盘为主** → 选择 VnPy（待实现）
- **两者都需要** → 可以同时使用两个框架

每个框架都有其优势，根据实际需求选择即可。
